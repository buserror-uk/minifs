#!/bin/hush

echo "* Mounting filesystems..."
mount -t proc /proc /proc
mount -t devtmpfs devtmpfs /dev
mount -t sysfs none /sys
mkdir -p /dev/pts /dev/shm
mount -t devpts devpts /dev/pts
mount -t tmpfs none /dev/shm
mount -t tmpfs none /tmp
# MOUNT FS -- do not delete this line
mount / / -o remount,noatime >/dev/null 2>&1
mkdir -p /tmp/run
mount /tmp/run /var/run/ -o bind

echo "* Starting system loggers..."
syslogd -C16
klogd

echo /sbin/mdev >/proc/sys/kernel/hotplug
# LOAD MODULES -- do not delete this line
echo "* Creating devices..."
/sbin/mdev -s

echo -n "* Setting hostname: "
hostname $(cat /etc/hostname) && hostname

echo "* Configuring loopback interface..."
ifconfig lo 127.0.0.1 up

up=$(ifconfig eth0|grep addr:)
if [ "$up" != "" ]; then
	echo "* eth0:$up"
	if [ -f /etc/network-up.sh ]; then sh /etc/network-up.sh ; fi
else
	echo "* Configuring network with DHCP..."
	ifconfig eth0 up
	udhcpc -b -T 1
fi
# Load DAC
modprobe snd-usb-audio index=0

# LAUNCH APPS -- do not delete this line
#echo "* Starting telnetd..."
#telnetd -l /bin/sh
